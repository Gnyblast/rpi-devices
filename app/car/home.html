<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Car</title>
    <link href="http://cdn.bootcss.com/bootstrap/3.3.5/css/bootstrap.min.css" rel="stylesheet" media="screen">
    <script src="http://libs.baidu.com/jquery/1.8.3/jquery.min.js"></script>

    <link href="https://gitcdn.github.io/bootstrap-toggle/2.2.2/css/bootstrap-toggle.min.css" rel="stylesheet">
    <script src="https://gitcdn.github.io/bootstrap-toggle/2.2.2/js/bootstrap-toggle.min.js"></script>

    <style type="text/css">
        * {
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            -khtml-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

        #video {
            max-width: 100%;
            height: auto;
        }

        /* #servoleft {
            margin-top: 0px;
            margin-left: 38px;
            padding: 10px 26px;
        }

        #servoahead {
            padding: 10px 26px;
        }

        #servoright {
            padding: 10px 26px;
        } */

        #forward {
            margin-top: 5px;
            margin-left: 130px;
            margin-bottom: 3px;
            padding: 16px 24px;
        }

        #left {
            margin-left: 45px;
            padding: 16px 24px;
        }

        #beep {
            padding: 16px 24px;
        }

        #right {
            padding: 16px 24px;
        }

        #backward {
            margin-top: 3px;
            margin-left: 130px;
            padding: 16px 24px;
        }

        #lat {
            resize: none;
            padding: 10px 0;
        }

        #lon {
            resize: none;
            padding: 10px 0;
        }

        #selfnav {
            margin-left: 6px;
            margin-top: 6px;
            padding: 10px 42px;
        }

        #stopnav {
            margin-top: 6px;
            margin-left: 10px;
            padding: 10px 42px;
        }

        #selftracking {
            margin-left: 45px;
            padding: 16px 24px;
        }

        .slidecontainer {
            width: 95%;
            margin-left: 10px;
        }
    </style>

    <script>
        var url = "http://((000.000.000.000)):8080"
        var xhr = new XMLHttpRequest();
        $(function () {
            $(function () {
                var slider = document.getElementById("volumeRange");
                var output = document.getElementById("currentVolume");
                output.innerHTML = slider.value + "%";

                slider.oninput = function () {
                    output.innerHTML = this.value + "%";
                    xhr.open("POST", url + "/volume/" + this.value, true);
                    xhr.send();
                }
            });
            
            // forward
            $('#forward').bind("touchstart", function (e) {
                document.getElementById("forward").style.color = "yellow";
                // $.post(url, { "op": "forward" }, function (data, status) { });
                xhr.open("POST", url + "/car/forward", true);
                xhr.send();
            });
            $('#forward').bind("touchend", function (e) {
                document.getElementById("forward").style.color = "white";
                // $.post(url, { "op": "stop" }, function (data, status) { });
                xhr.open("POST", url + "/car/stop", true);
                xhr.send();
            });
            // backward
            $('#backward').bind("touchstart", function (e) {
                document.getElementById("backward").style.color = "yellow";
                // $.post(url, { "op": "backward" }, function (data, status) { });
                xhr.open("POST", url + "/car/backward", true);
                xhr.send();
            });
            $('#backward').bind("touchend", function (e) {
                document.getElementById("backward").style.color = "white";
                // $.post(url, { "op": "stop" }, function (data, status) { });
                xhr.open("POST", url + "/car/stop", true);
                xhr.send();
            });
            // stop
            $('#stop').bind("touchstart", function (e) {
                document.getElementById("stop").style.color = "yellow";
                // $.post(url, { "op": "stop" }, function (data, status) { });
                xhr.open("POST", url + "/car/stop", true);
                xhr.send();
            });
            $('#stop').bind("touchend", function (e) {
                document.getElementById("stop").style.color = "white";
            });
            // left
            $('#left').bind("touchstart", function (e) {
                document.getElementById("left").style.color = "yellow";
                // $.post(url, { "op": "left" }, function (data, status) { });
                xhr.open("POST", url + "/car/left", true);
                xhr.send();
            });
            $('#left').bind("touchend", function (e) {
                document.getElementById("left").style.color = "white";
                // $.post(url, { "op": "stop" }, function (data, status) { });
                xhr.open("POST", url + "/car/stop", true);
                xhr.send();
            });
            // right
            $('#right').bind("touchstart", function (e) {
                document.getElementById("right").style.color = "yellow";
                // $.post(url, { "op": "right" }, function (data, status) { });
                xhr.open("POST", url + "/car/right", true);
                xhr.send();
            });
            $('#right').bind("touchend", function (e) {
                document.getElementById("right").style.color = "white";
                // $.post(url, { "op": "stop" }, function (data, status) { });
                xhr.open("POST", url + "/car/stop", true);
                xhr.send();
            });
            // beep
            $('#beep').bind("touchstart", function (e) {
                document.getElementById("beep").style.color = "yellow";
                // $.post(url, { "op": "beep" }, function (data, status) { });
                xhr.open("POST", url + "/car/beep", true);
                xhr.send();
            });
            $('#beep').bind("touchend", function (e) {
                document.getElementById("beep").style.color = "lightgray";
            });
            
            // servoleft
            // $('#servoleft').bind("touchstart", function (e) {
            //     $.post(url, { "op": "servoleft" }, function (data, status) { });
            //     document.getElementById("servoleft").style.color = "yellow";
            // });
            // $('#servoleft').bind("touchend", function (e) {
            //     document.getElementById("servoleft").style.color = "lightgray";
            // });
            // servoahead
            // $('#servoahead').bind("touchstart", function (e) {
            //     $.post(url, { "op": "servoahead" }, function (data, status) { });
            //     document.getElementById("servoahead").style.color = "yellow";
            // });
            // $('#servoahead').bind("touchend", function (e) {
            //     document.getElementById("servoahead").style.color = "lightgray";
            // });
            // servoright
            // $('#servoright').bind("touchstart", function (e) {
            //     $.post(url, { "op": "servoright" }, function (data, status) { });
            //     document.getElementById("servoright").style.color = "yellow";
            // });
            // $('#servoright').bind("touchend", function (e) {
            //     document.getElementById("servoright").style.color = "lightgray";
            // });
            // music
            $('#music').change(function () {
                if ($(this).prop('checked')) {
                    // $.post(url, { "op": "musicon" }, function (data, status) { });
                    xhr.open("POST", url + "/music/on", true);
                    xhr.send();
                } else {
                    // $.post(url, { "op": "musicoff" }, function (data, status) { });
                    xhr.open("POST", url + "/music/off", true);
                    xhr.send();
                }
            })
            // self-driving
            $('#selfdriving').change(function () {
                if ($(this).prop('checked')) {
                    // $.post(url, { "op": "selfdrivingon" }, function (data, status) { });
                    $('#selftracking').bootstrapToggle('disable')
                    $('#speechdriving').bootstrapToggle('disable')
                    xhr.open("POST", url + "/selfdriving/on", true);
                    xhr.send();
                } else {
                    // $.post(url, { "op": "selfdrivingoff" }, function (data, status) { });
                    $('#selftracking').bootstrapToggle('enable')
                    $('#speechdriving').bootstrapToggle('enable')
                    xhr.open("POST", url + "/selfdriving/off", true);
                    xhr.send();
                }
            })
            // self-tracking
            $('#selftracking').change(function () {
                if ($(this).prop('checked')) {
                    $('#selfdriving').bootstrapToggle('disable');
                    $('#speechdriving').bootstrapToggle('disable');
                    // $.post(url, { "op": "selftrackingon" }, function (data, status) { });
                    xhr.open("POST", url + "/selftracking/on", true);
                    xhr.send();
                    setTimeout(function () {
                        window.location.reload();
                    }, 3000);
                } else {
                    $('#selfdriving').bootstrapToggle('enable');
                    $('#speechdriving').bootstrapToggle('enable');
                    // $.post(url, { "op": "selftrackingoff" }, function (data, status) { });
                    xhr.open("POST", url + "/selftracking/off", true);
                    xhr.send();
                    setTimeout(function () {
                        window.location.reload();
                    }, 3000);
                }
            })
            // speech-driving
            $('#speechdriving').change(function () {
                if ($(this).prop('checked')) {
                    $('#selfdriving').bootstrapToggle('disable');
                    $('#selftracking').bootstrapToggle('disable');
                    // $.post(url, { "op": "speechdrivingon" }, function (data, status) { });
                    xhr.open("POST", url + "/speechdriving/on", true);
                    xhr.send();
                } else {
                    $('#selfdriving').bootstrapToggle('enable');
                    $('#selftracking').bootstrapToggle('enable');
                    // $.post(url, { "op": "speechdrivingoff" }, function (data, status) { });
                    xhr.open("POST", url + "/speechdriving/off", true);
                    xhr.send();
                }
            })
            // selfnav
            $('#selfnav').bind("touchstart", function (e) {
                document.getElementById("selfnav").style.color = "yellow";
                lat = document.getElementById("lat").value;
                lon = document.getElementById("lon").value;
                // $.post(url, { "dest": dest, "op": "selfnavon" }, function (data, status) { });
                xhr.open("POST", url + "/selfnav/"+lat+"/"+lon, true);
                xhr.send();
            });
            $('#selfnav').bind("touchend", function (e) {
                document.getElementById("selfnav").style.color = "white";
            });
            // stop nav
            $('#stopnav').bind("touchstart", function (e) {
                document.getElementById("stopnav").style.color = "yellow";
                // $.post(url, { "op": "selfnavoff" }, function (data, status) { });
                xhr.open("POST", url + "/selfnav/off", true);
                xhr.send();
            });
            $('#stopnav').bind("touchend", function (e) {
                document.getElementById("stopnav").style.color = "lightgray";
            });
            // selftracking
            // $('#selftracking').bind("click", function (e) {
            //     $.post(url, { "op": "selftrackingon" }, function (data, status) { });
            //     // window.location.href = 'http://((000.000.000.000)):8088/video';
            //     window.location.href = 'http://((000.000.000.000)):8080/tracking';
            // });

            // window.addEventListener( "pageshow", function ( event ) {
            //     var historyTraversal = event.persisted || 
            //                             ( typeof window.performance != "undefined" && 
            //                                 window.performance.navigation.type === 2 );
            //     if ( historyTraversal ) {
            //         // Handle page restore.
            //         window.location.reload();
            //     }
            //     window.location.reload();
            // });
        });
    </script>
</head>

<body>
    <img id="video" src="http://((000.000.000.000)):8081">
    <div id="container" class="container">
        <!-- <div>
            <button id='servoleft' class="btn btn-lg glyphicon glyphicon glyphicon-arrow-left"
                style="font-size:32px; color:lightgray"></button>
            <button id='servoahead' class="btn btn-lg glyphicon glyphicon glyphicon glyphicon-upload"
                style="font-size:32px; color:lightgray"></button>
            <button id='servoright' class="btn btn-lg glyphicon glyphicon glyphicon-arrow-right"
                style="font-size:32px; color:lightgray"></button>
        </div> -->
        <div>
            <button id="forward" class="btn btn-lg btn-primary glyphicon glyphicon-chevron-up"
                style="font-size:32px"></button>
        </div>
        <div>
            <button id='left' class="btn btn-lg btn-primary glyphicon glyphicon-chevron-left"
                style="font-size:32px"></button>
            <button id='beep' class="btn btn-lg btn-default glyphicon glyphicon glyphicon-volume-up"
                style="font-size:32px; color:lightgray"></button>
            <button id='right' class="btn btn-lg btn-primary glyphicon glyphicon-chevron-right"
                style="font-size:32px"></button>
        </div>
        <div>
            <button id='backward' class="btn btn-lg btn-primary glyphicon glyphicon-chevron-down"
                style="font-size:32px"></button>
        </div>
        <br /><br /><br />
        <div>
            <input id="selfdriving" type="checkbox" ((selfdriving-state)) ((selfdriving-enabled)) data-toggle="toggle"
                data-on="Self-Driving" data-off="Self-Driving" data-onstyle="warning" data-width="130" data-height="45">
            <input id="selftracking" type="checkbox" ((selftracking-state)) ((selftracking-enabled))
                data-toggle="toggle" data-on="Self-Tracking" data-off="Self-Tracking" data-onstyle="warning"
                data-width="130" data-height="45">
            <!-- <button id='selftracking' class="btn btn-lg btn-primary">SelfTracking</button> -->
        </div>
        <br />
        <div>
            <input id="speechdriving" type="checkbox" ((speechdriving-state)) ((speechdriving-enabled))
                data-toggle="toggle" data-on="Speech-Driving" data-off="Speech-Driving" data-onstyle="warning"
                data-width="130" data-height="45">
            <input id="music" type="checkbox" ((music-state)) data-toggle="toggle" data-on="Music" data-off="Music"
                data-onstyle="warning" data-width="130" data-height="45">
        </div>
        <hr>
        <div>
            <textarea id="lat" name="lattext" rows="1" cols="30" maxlength="30" placeholder=" lat"></textarea>
            <textarea id="lon" name="lontext" rows="1" cols="30" maxlength="30" placeholder=" lon"></textarea>
            <br />
            <button id="selfnav" class="btn btn-lg btn-warning">Nav</button>
            <button id="stopnav" class="btn btn-lg btn-default" style="color:lightgray">Stop</button>
        </div>
        <br />
        <div class="slidecontainer">
            <br />
            <p>current volume: <span id="currentVolume"></span></p>
            <input type="range" min="1" max="100" value="((current-volume))" class="slider" id="volumeRange">
        </div>
        <br /><br /><br />
    </div>
</body>

</html>
